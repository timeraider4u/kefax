/*
 * generated by Xtext 2.9.0-SNAPSHOT
 */
package at.jku.weiner.xtexttest.generator

import org.eclipse.emf.ecore.resource.Resource
import org.eclipse.xtext.generator.IFileSystemAccess
import org.eclipse.xtext.generator.IGenerator
import org.eclipse.emf.common.util.URI
import org.eclipse.xtend.lib.annotations.Accessors
import at.jku.weiner.xtexttest.xtextTest.Model
import at.jku.weiner.log.MyLog

/**
 * Generates code from your model files on save.
 * 
 * See https://www.eclipse.org/Xtext/documentation/303_runtime_concepts.html#code-generation
 */
class XtextTestGenerator implements IGenerator {
	private Model model;
	private URI uri;
	
	@Accessors String fileName;

	override void doGenerate(Resource resource, IFileSystemAccess fsa) {
		uri = resource.URI;
		MyLog.trace(XtextTestGenerator.getClass, "uri='" + uri + "'");
		model = resource.allContents.filter(typeof(Model)).head;
		
		if (model.xtextTest != null) {
			val MyXtextTestGenerator generator = new MyXtextTestGenerator();
			generator.doGenerate(resource, fsa, model);
		}
		else {
			val EmfTestGenerator generator = new EmfTestGenerator();
			generator.doGenerate(resource, fsa, model);
		}
	}
		
}
